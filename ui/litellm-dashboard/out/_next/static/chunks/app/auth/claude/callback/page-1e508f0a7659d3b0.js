(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[641],{40828:function(e,t,s){Promise.resolve().then(s.bind(s,42582))},42582:function(e,t,s){"use strict";s.d(t,{default:function(){return l}});var n=s(57437),o=s(2265),i=s(99376),c=s(42264),r=s(87908),u=s(8110),a=s(19250);function l(){let e=(0,i.useSearchParams)(),t=(0,i.useRouter)(),[s,l]=(0,o.useState)(!0),[d,h]=(0,o.useState)(null);(0,o.useEffect)(()=>{m()},[e]);let m=async()=>{let s=e.get("code"),n=e.get("state"),o=e.get("error"),i=e.get("error_description");if(o){h(i||o),l(!1),c.ZP.error("OAuth error: ".concat(i||o)),window.opener&&setTimeout(()=>{window.close()},3e3);return}if(!s||!n){h("Missing authorization code or state"),l(!1);return}if(sessionStorage.getItem("claude_oauth_state")!==n){h("Invalid state parameter - possible CSRF attack"),l(!1);return}try{let e=localStorage.getItem("accessToken");if(!e){h("No access token found. Please log in."),l(!1);return}let o=await (0,a.completeClaudeOAuth)(e,s,n);if(o.success)c.ZP.success("Claude OAuth connected successfully!"),sessionStorage.removeItem("claude_oauth_state"),window.opener?(window.opener.postMessage({type:"oauth-success"},"*"),window.close()):t.push("/settings?tab=claude-oauth");else throw Error(o.message||"Failed to complete OAuth")}catch(e){h(e.message||"Failed to complete OAuth flow"),l(!1),c.ZP.error("Failed to complete OAuth authentication"),window.opener&&setTimeout(()=>{window.close()},3e3)}};return s?(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen",children:[(0,n.jsx)(r.Z,{size:"large"}),(0,n.jsx)("p",{className:"mt-4 text-gray-600",children:"Completing OAuth authentication..."})]}):d?(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,n.jsx)(u.ZP,{status:"error",title:"OAuth Authentication Failed",subTitle:d,extra:window.opener?(0,n.jsx)("p",{children:"This window will close automatically..."}):(0,n.jsx)("button",{onClick:()=>t.push("/settings"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Settings"})})}):(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,n.jsx)(u.ZP,{status:"success",title:"OAuth Authentication Successful",subTitle:"You have successfully connected your Claude account.",extra:window.opener?(0,n.jsx)("p",{children:"This window will close automatically..."}):(0,n.jsx)("button",{onClick:()=>t.push("/settings"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Go to Settings"})})})}}},function(e){e.O(0,[491,908,110,49,971,117,744],function(){return e(e.s=40828)}),_N_E=e.O()}]);